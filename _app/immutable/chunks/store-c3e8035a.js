var $=Object.defineProperty;var G=(t,e,s)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var n=(t,e,s)=>(G(t,typeof e!="symbol"?e+"":e,s),s);import{w as g}from"./index-c420ff7b.js";import{T as l}from"./index-41483ea5.js";const E={INT:/^-?[0-9]+$/,FLOAT:/^-?[0-9]+\.[0-9]+$/,SPACE:/^( +)/},P=t=>{t=t.replace(/\r\n/g,`
`).replace(/\n *\n/g,`
`).replace(/ +\n/g,`
`);const e=new k,s=0,i=t.split(`
`);return e.parse(i,s,0),e},M=t=>{const e=t.match(E.SPACE);return e?e[1].length:0};class k{constructor(e){n(this,"key");n(this,"data",{});n(this,"put",(e,s)=>{this.data[e]=s});n(this,"has",e=>this.data[e]!==void 0);n(this,"get",(e,s,i)=>((this.data[e]=="[]"||this.data[e]==" []")&&(this.data[e]=JSON.parse(this.data[e].trim())),this.has(e)?i?i(this.data[e]):this.data[e]:s));n(this,"remove",e=>{delete this.data[e]});n(this,"parse",(e,s,i,r)=>{for(r&&(this.key=r);s<e.length&&M(e[s])>=i;){for(;s<e.length&&(M(e[s])!=i||e[s].replace(/ /g,"").charAt(0)=="#"||e[s].indexOf(":")==-1);)s++;if(s==e.length)return s;let c=e[s].substring(i,e[s].indexOf(":"));if(c.match(/^["'].*["']$/)&&(c=c.substring(1,c.length-1)),!this.key&&!r&&(this.key=c),e[s].indexOf(": {}")==e[s].length-4&&e[s].length>=4)this.data[c]={};else if(s<e.length-1&&e[s+1].charAt(i)=="-"&&e[s+1].charAt(i+1)==" "&&M(e[s+1])==i){const o=[];for(;++s<e.length&&e[s].charAt(i)=="-";){let h=e[s].substring(i+2);(h.charAt(0)=="'"||h.charAt(0)=='"')&&(h=h.substring(1,h.length-1).replace(/\\(['"])/,m=>m.replace("\\",""))),o.push(h)}this.data[c]=o,s--}else if(s<e.length-1&&M(e[s+1])>i){s++;const o=M(e[s]),h=new k;s=h.parse(e,s,o,c)-1,this.data[c]=h}else{let o=e[s].substring(e[s].indexOf(":")+2);o.charAt(0)=="'"||o.charAt(0)=='"'?o=o.substring(1,o.length-1):isNaN(o)||(E.INT.test(o)?o=parseInt(o):o=parseFloat(o)),typeof o=="string"&&(o=="false"?o=!1:o=="true"?o=!0:o=o.replace(/\\(['"])/,h=>h.replace("\\",""))),this.data[c]=o}do s++;while(s<e.length&&e[s].replace(/ /g,"").charAt(0)=="#")}return Object.keys(this.data).length==1&&this.key&&this.data[this.key]instanceof k&&(this.data=this.data[this.key].data),s});n(this,"toString",()=>this.toYaml(this.key||this.data.name?"'"+(this.key||this.data.name)+"'":void 0,this.data));n(this,"toYaml",(e,s,i="")=>{let r="";e&&(r+=i+e+`:
`,i+="  ");for(const c of Object.keys(s)){const o=s[c],h=JSON.stringify(o);let m=i+c+": "+h+`
`;if(o!=null){if(o instanceof Object)if(Object.keys(o).includes("toYaml"))if(o instanceof k){r+=o.toYaml("'"+c+"'",o.data,i);continue}else m=o.toYaml(i);else o instanceof Array&&(c!="attributes"?(m=i+c+":",o.length>0&&["string","number"].includes(typeof o[0])?(m+=`
`,o.forEach(v=>m+=i+"- "+JSON.stringify(v)+`
`)):o.length==0&&(m+=` []
`)):m=this.toYaml(c,o,i));m&&(r+=m.replaceAll(/(\\)?'/g,"\\'").replaceAll(/((\\)?")/g,v=>v.length==1?"'":v).replaceAll(/\\"/g,'"'))}}return r});this.key=e}}class a{constructor(e,s,i){n(this,"name");n(this,"base");n(this,"scale");n(this,"toYaml",(e="")=>e+this.name.toLowerCase()+"-base: "+this.base+`
`+e+this.name.toLowerCase()+"-scale: "+this.scale+`
`);this.name=e,this.base=s,this.scale=i}}const N=t=>t.replace("_"," ").toLowerCase().replace(/^(.)|\s(.)/g,e=>e.toUpperCase()),H=t=>(t=t.replace("_"," "),t.substring(0,1).toUpperCase()+t.substring(1).toLowerCase());class S{constructor(e){n(this,"isClass",!0);n(this,"key",{});n(this,"name");n(this,"prefix","");n(this,"group","class");n(this,"manaName","&2Mana");n(this,"maxLevel",40);n(this,"parent");n(this,"permission",!1);n(this,"expSources",273);n(this,"manaRegen",1);n(this,"health",new a("health",20,1));n(this,"mana",new a("mana",20,1));n(this,"attributes",[]);n(this,"skillTree","Requirement");n(this,"skills",[]);n(this,"icon",{material:"Pumpkin",customModelData:0});n(this,"unusableItems",[]);n(this,"actionBar","");n(this,"updateAttributes",e=>{e||(e=l(U)||[]);const s=[];this.attributes=this.attributes.filter(i=>e!=null&&e.includes(i.name)?(s.push(i.name),!0):!1),e=e.filter(i=>!s.includes(i));for(const i of e)this.attributes.push(new a(i,0,0))});n(this,"serializeYaml",()=>{var i;const e=new k(this.name),s=new k;return s.put("name",this.name),s.put("action-bar",this.actionBar),s.put("prefix",this.prefix),s.put("group",this.group),s.put("mana",this.manaName),s.put("max-level",this.maxLevel),s.put("parent",((i=this.parent)==null?void 0:i.name)||""),s.put("permission",this.permission),s.put("attributes",[this.health,this.mana,...this.attributes]),s.put("mana-regen",this.manaRegen),s.put("tree",this.skillTree.toUpperCase().replace(/ /g,"_")),s.put("blacklist",this.unusableItems),s.put("skills",this.skills.map(r=>r.name)),s.put("icon",this.icon.material),s.put("icon-data",this.icon.customModelData),s.put("icon-lore",this.icon.lore),s.put("exp-source",this.expSources),e.data=s.data,e});n(this,"load",e=>{console.log(e),this.name=e.get("name",this.name),this.actionBar=e.get("action-bar",this.actionBar),this.prefix=e.get("prefix",this.prefix),this.group=e.get("group",this.group),this.mana=e.get("mana",this.mana),this.maxLevel=e.get("max-level",this.maxLevel),this.parent=e.get("parent",this.parent,R),this.permission=e.get("permission",this.permission),this.attributes=e.get("attributes",this.attributes,s=>{const i=[],r=s.get("health-base",20),c=s.get("health-scale",1),o=s.get("mana-base",20),h=s.get("mana-scale",1);this.health=new a("health",r,c),this.mana=new a("mana",o,h),s.remove("health-base"),s.remove("health-scale"),s.remove("mana-base"),s.remove("mana-scale");const m={};return Object.keys(s.data).forEach(v=>{const T=v.split("-"),C=N(T[0]);m[C]||(m[C]=new a(C,0,0));const I=m[C];T[1]=="base"&&(I.base=Number.parseFloat(s.data[v])),T[1]=="scale"&&(I.scale=Number.parseFloat(s.data[v]))}),i.push(...Object.values(m)),console.log("att",i),i}),this.manaRegen=e.get("mana-regen",this.manaRegen),this.skillTree=e.get("tree",this.skillTree,N),this.unusableItems=e.get("blacklist",this.unusableItems),this.skills=e.get("skills",this.skills,s=>s.map(i=>V(i)).filter(i=>!!i)),this.icon.material=e.get("icon",this.icon.material,H),this.icon.customModelData=e.get("icon-data",this.icon.customModelData),this.icon.lore=e.get("icon-lore",this.icon.lore),this.expSources=e.get("exp-source",this.expSources),console.log(this)});this.name=e?e.name:"Class",e!=null&&e.prefix?this.prefix=e.prefix:this.prefix="&6"+this.name,e!=null&&e.group&&(this.group=e.group),e!=null&&e.manaName&&(this.manaName=e.manaName),e!=null&&e.maxLevel&&(this.maxLevel=e.maxLevel),e!=null&&e.parent&&(this.parent=e.parent),e!=null&&e.permission&&(this.permission=e.permission),e!=null&&e.expSources&&(this.expSources=e.expSources),e!=null&&e.health&&(this.health=e.health),e!=null&&e.mana&&(this.mana=e.mana),e!=null&&e.manaRegen&&(this.manaRegen=e.manaRegen),e!=null&&e.attributes&&(this.attributes=e.attributes),e!=null&&e.skillTree&&(this.skillTree=e.skillTree),e!=null&&e.skills&&(this.skills=e.skills),e!=null&&e.icon&&(this.icon=e.icon),e!=null&&e.unusableItems&&(this.unusableItems=e.unusableItems),e!=null&&e.actionBar&&(this.actionBar=e.actionBar)}}class q{constructor(e){n(this,"isSkill",!0);n(this,"key",{});n(this,"name");n(this,"type","Dynamic");n(this,"maxLevel",5);n(this,"skillReq");n(this,"skillReqLevel");n(this,"permission",!1);n(this,"levelReq",1);n(this,"levelReqModifier",0);n(this,"cost",1);n(this,"costModifier",0);n(this,"cooldown",0);n(this,"cooldownModifier",0);n(this,"cooldownMessage",!0);n(this,"mana",0);n(this,"manaModifier",0);n(this,"minSpent",0);n(this,"minSpentModifier",0);n(this,"castMessage","&6{player} &2has cast &6{skill}");n(this,"combo");n(this,"indicator","2D");n(this,"icon",{material:"Pumpkin",customModelData:0});n(this,"incompatible",[]);n(this,"triggers",[]);n(this,"serializeYaml",()=>{const e=new k;return e.data.name=this.name,e});this.name=e?e.name:"Skill",e!=null&&e.type&&(this.type=e.type),e!=null&&e.maxLevel&&(this.maxLevel=e.maxLevel),e!=null&&e.skillReq&&(this.skillReq=e.skillReq),e!=null&&e.skillReqLevel&&(this.skillReqLevel=e.skillReqLevel),e!=null&&e.permission&&(this.permission=e.permission),e!=null&&e.levelReq&&(this.levelReq=e.levelReq),e!=null&&e.levelReqModifier&&(this.levelReqModifier=e.levelReqModifier),e!=null&&e.cost&&(this.cost=e.cost),e!=null&&e.costModifier&&(this.costModifier=e.costModifier),e!=null&&e.cooldown&&(this.cooldown=e.cooldown),e!=null&&e.cooldownModifier&&(this.cooldownModifier=e.cooldownModifier),e!=null&&e.cooldownMessage&&(this.cooldownMessage=e.cooldownMessage),e!=null&&e.mana&&(this.mana=e.mana),e!=null&&e.manaModifier&&(this.manaModifier=e.manaModifier),e!=null&&e.minSpent&&(this.minSpent=e.minSpent),e!=null&&e.minSpentModifier&&(this.minSpentModifier=e.minSpentModifier),e!=null&&e.castMessage&&(this.castMessage=e.castMessage),e!=null&&e.combo&&(this.combo=e.combo),e!=null&&e.indicator&&(this.indicator=e.indicator),e!=null&&e.icon&&(this.icon=e.icon),e!=null&&e.incompatible&&(this.incompatible=e.incompatible),e!=null&&e.triggers&&(this.triggers=e.triggers)}}class f{constructor(e){this.key={},this.isFolder=!0,this.open=!1,this.name="Folder",this.data=[],this.updateParent=s=>{this.parent=s},this.add=s=>{this.data.includes(s)||(s instanceof f&&(O(s,this.data),W(s),s.parent=this),this.data.push(s),this.sort())},this.remove=s=>{this.data=this.data.filter(i=>i!=s),this.sort()},this.sort=()=>{this.data=this.data.sort((s,i)=>{let r=0;return s instanceof f&&(i instanceof f||(r=-100)),s.name.localeCompare(i.name)+r}),x()},this.createFolder=()=>{const s=new f;O(s,this.data),this.data.push(s),this.sort(),s.updateParent(this)},this.deleteFolder=s=>{this.data=this.data.filter(i=>i!=s)},this.contains=s=>{if(this.data.includes(s))return!0;for(const i of this.data.filter(r=>r instanceof f))if(i.contains(s))return!0;return!1},this.getContainingFolder=s=>{if(this.data.includes(s))return this;for(const i of this.data.filter(r=>r instanceof f))if(i.contains(s))return i},e&&(this.data=e,e.forEach(s=>{s instanceof f&&s.isFolder&&s.updateParent(this)}))}}const Y=g(),z=g(),ie=g(),y=g(!0),ne=g(!0),A=g(!0),Q=g(!1),u=g([new q({name:"Particle Blast",type:"Dynamic",maxLevel:40,permission:!1,levelReq:1,levelReqModifier:0,cost:0,costModifier:0,cooldown:0,cooldownModifier:0,cooldownMessage:!1,mana:3,manaModifier:0,minSpent:0,minSpentModifier:0,castMessage:"&6{player} &2has cast &6{skill}",indicator:"2D",icon:{material:"Diamond",customModelData:0},triggers:[]}),new q({name:"Poison Dart",type:"Dynamic",maxLevel:40,permission:!1,levelReq:1,levelReqModifier:0,cost:0,costModifier:0,cooldown:0,cooldownModifier:0,cooldownMessage:!1,mana:3,manaModifier:0,minSpent:0,minSpentModifier:0,castMessage:"&6{player} &2has cast &6{skill}",indicator:"2D",icon:{material:"Diamond",customModelData:0},triggers:[]}),new q({name:"Storm",type:"Dynamic",maxLevel:40,permission:!1,levelReq:1,levelReqModifier:0,cost:0,costModifier:0,cooldown:0,cooldownModifier:0,cooldownMessage:!1,mana:3,manaModifier:0,minSpent:0,minSpentModifier:0,castMessage:"&6{player} &2has cast &6{skill}",indicator:"2D",icon:{material:"Diamond",customModelData:0},triggers:[]})]),p=g([new S({name:"Honor Guard",group:"class",manaName:"&2Mana",maxLevel:40,permission:!1,health:new a("health",20,1),mana:new a("mana",20,1),manaRegen:1,attributes:[new a("vitality",2,1)],skillTree:"Requirement",skills:[],icon:{material:"Pumpkin",customModelData:0,lore:["This is a class","Lore line two"]},unusableItems:[]}),new S({name:"Assassin",group:"class",manaName:"&2Mana",maxLevel:40,permission:!1,health:new a("health",20,1),mana:new a("mana",20,1),manaRegen:1,attributes:[new a("vitality",2,1),new a("bravery",2,1)],skillTree:"Requirement",skills:[l(u)[0],l(u)[1]],icon:{material:"Pumpkin",customModelData:0,lore:['This is" a class']},unusableItems:[]}),new S({name:"Archer",group:"class",manaName:"&2Mana",maxLevel:40,permission:!1,health:new a("health",20,1),mana:new a("mana",20,1),manaRegen:1,attributes:[new a("vitality",2,1)],skillTree:"Requirement",skills:[],icon:{material:"Pumpkin",customModelData:0,lore:["This is a class"]},unusableItems:[]})]),w=g([new f([new f([l(p)[0]])])]),b=g([new f([new f([l(u)[0]])])]),U=(()=>{let t=["vitality","spirit","intelligence","dexterity","strength"];{const r=localStorage.getItem("attribs");r&&(t=r.split(","),l(p).forEach(c=>c.updateAttributes(t)))}const{subscribe:e,set:s,update:i}=g(t);return{subscribe:e,set:r=>(localStorage.setItem("attribs",r.join(",")),l(p).forEach(c=>c.updateAttributes(r)),s(r)),update:i}})(),oe=(t,e)=>{Y.set(t),z.set(e)},le=()=>{l(y)&&(l(z)=="class"?p.set(l(p)):u.set(l(u)),x())},re=()=>y.set(!l(y)),ce=()=>y.set(!1),ae=()=>A.set(!0),he=()=>A.set(!1),me=t=>Q.set(t),R=t=>{for(const e of l(p))if(e.name==t)return e},L=t=>!!R(t),B=t=>{const e=l(p),s=new S({name:t||"Class "+(e.length+1)});return e.push(s),p.set(e),s},V=t=>{for(const e of l(u))if(e.name==t)return e},fe=t=>{const e=l(u),s=new q({name:t||"Skill "+(e.length+1)});return e.push(s),u.set(e),s},ue=t=>{const e=l(w);e.includes(t)||(O(t,e),e.push(t),e.sort((s,i)=>s.name.localeCompare(i.name)),w.set(e))},pe=t=>{const e=l(b);e.includes(t)||(O(t,e),e.push(t),e.sort((s,i)=>s.name.localeCompare(i.name)),b.set(e))},O=(t,e)=>{const s=t.name;let i=1;for(;e.filter(r=>r instanceof f&&r.name==t.name).length>=1;)t.name=s+" ("+i+++")"},ge=t=>{if(t.parent)t.parent.deleteFolder(t),x();else if(l(A)){const e=l(w).filter(s=>s!=t);w.set(e)}else{const e=l(b).filter(s=>s!=t);b.set(e)}},ke=t=>{var e;t&&((e=X(t))==null||e.remove(t),p.set(l(p).filter(s=>s!=t)),u.set(l(u).filter(s=>s!=t)),x())},x=()=>{l(y)&&(l(A)?(w.set(D(l(w))),p.set(D(l(p)))):(b.set(D(l(b))),u.set(D(l(u)))))},we=()=>{const t=l(p),e=l(u),s=new k,i=new k;s.put("loaded",!1),i.put("loaded",!1),t.forEach(r=>s.put(r.name,r.serializeYaml())),t.length>0&&localStorage.setItem("classData",s.toString()),e.length>0&&localStorage.setItem("skillData",i.toString()),console.log(i.toString())},D=t=>t.sort((e,s)=>e.name.localeCompare(s.name)),W=t=>{const e=l(w),s=l(b);e.includes(t)&&w.set(e.filter(i=>i!=t)),s.includes(t)&&b.set(s.filter(i=>i!=t))},X=t=>{if(t instanceof f)return t.parent;const e=t instanceof S?l(w):l(b);for(const s of e){const i=s.getContainingFolder(t);if(i)return i}},J=t=>{const e=P(t),s=Object.keys(e.data);U.set(s)},Z=t=>{},F=t=>{const e=P(t);let s;if(e.key&&!e.data[e.key]){const i=e.key;console.log(i,L(i),R(i)),s=L(i)?R(i):B(i),s.load(e);return}for(const i in e.data)i!="loaded"&&e.data[i]instanceof k&&!L(i)&&(s=L(i)?R(i):B(i),s.load(e.data[i]),console.log(s))},j=t=>{var s;const e=(s=t.target)==null?void 0:s.result;e&&F(e)},K=t=>{var s;(s=t.target)!=null&&s.result},_=t=>{var s;const e=(s=t.target)==null?void 0:s.result;e&&(e.indexOf("global:")>=0?J(e):e.indexOf("components:")>=0||e.indexOf("group:")==-1&&e.indexOf("combo:")==-1&&e.indexOf("skills:")==-1||F(e),document.activeElement.blur())},be=t=>{t.indexOf("global:")>=0?J(t):t.indexOf("components:")>=0||t.indexOf("group:")==-1&&t.indexOf("combo:")==-1&&t.indexOf("skills:")==-1?Z(t.replace(`loaded: false
`,"")):F(t.replace(`loaded: false
`,""))},ve=t=>{const e=new FileReader;t.name.indexOf("skills")==0?e.onload=K:t.name.indexOf("classes")==0?e.onload=j:e.onload=_,e.readAsText(t)},Me=t=>{const e=t||l(Y);e&&d(e.name+".yml",e.serializeYaml().toString())},d=(t,e)=>{const s=new Blob([e],{type:"text/plain;charset=utf-8"}),i=document.createElement("a");i.href=URL.createObjectURL(s),i.download=t,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)};export{z as A,re as B,y as C,Q as D,U as E,a as F,le as G,we as H,N as I,oe as J,f as P,ve as a,Y as b,ne as c,ie as d,ue as e,pe as f,X as g,Me as h,A as i,ke as j,ge as k,be as l,ae as m,he as n,w as o,p,b as q,W as r,me as s,u as t,x as u,B as v,fe as w,S as x,q as y,ce as z};
