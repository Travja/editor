var ce=Object.defineProperty;var he=(i,e,t)=>e in i?ce(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var l=(i,e,t)=>(he(i,typeof e!="symbol"?e+"":e,t),t);import{w as f,j as L,k as me}from"./singletons.f5c86a4d.js";import{U as a}from"./index.3926e6cc.js";let A;const ue=new Uint8Array(16);function pe(){if(!A&&(A=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!A))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A(ue)}const u=[];for(let i=0;i<256;++i)u.push((i+256).toString(16).slice(1));function fe(i,e=0){return(u[i[e+0]]+u[i[e+1]]+u[i[e+2]]+u[i[e+3]]+"-"+u[i[e+4]]+u[i[e+5]]+"-"+u[i[e+6]]+u[i[e+7]]+"-"+u[i[e+8]]+u[i[e+9]]+"-"+u[i[e+10]]+u[i[e+11]]+u[i[e+12]]+u[i[e+13]]+u[i[e+14]]+u[i[e+15]]).toLowerCase()}const ge=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Q={randomUUID:ge};function de(i,e,t){if(Q.randomUUID&&!e&&!i)return Q.randomUUID();i=i||{};const s=i.random||(i.rng||pe)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){t=t||0;for(let n=0;n<16;++n)e[t+n]=s[n];return e}return fe(s)}const ee={INT:/^-?[0-9]+$/,FLOAT:/^-?[0-9]+\.[0-9]+$/,SPACE:/^( +)/},N=i=>{i=i.replace(/\r\n/g,`
`).replace(/\n *\n/g,`
`).replace(/ +\n/g,`
`);const e=new h,t=0,s=i.split(`
`);return e.parse(s,t,0),e},I=i=>{const e=i.match(ee.SPACE);return e?e[1].length:0};class h{constructor(e){l(this,"key");l(this,"data",{});l(this,"put",(e,t)=>{this.data[e]=t});l(this,"has",e=>this.data[e]!==void 0);l(this,"get",(e,t,s)=>((this.data[e]=="[]"||this.data[e]==" []")&&(this.data[e]=JSON.parse(this.data[e].trim())),this.has(e)?s?s(this.data[e]):this.data[e]:t));l(this,"getKeys",()=>Object.keys(this.data));l(this,"remove",e=>{delete this.data[e]});l(this,"parse",(e,t,s,n)=>{for(n&&(this.key=n);t<e.length&&I(e[t])>=s;){for(;t<e.length&&(I(e[t])!=s||e[t].replace(/ /g,"").charAt(0)=="#"||e[t].indexOf(":")==-1);)t++;if(t==e.length)return t;let r=e[t].substring(s,e[t].indexOf(":"));if(r==="loaded"){t++;continue}if(r.match(/^["'].*["']$/)&&(r=r.substring(1,r.length-1)),!this.key&&!n&&(this.key=r),e[t].indexOf(": {}")==e[t].length-4&&e[t].length>=4)this.data[r]={};else if(t<e.length-1&&e[t+1].charAt(s)=="-"&&e[t+1].charAt(s+1)==" "&&I(e[t+1])==s){const o=[];for(;++t<e.length&&e[t].charAt(s)=="-";){let c=e[t].substring(s+2);(c.charAt(0)=="'"||c.charAt(0)=='"')&&(c=c.substring(1,c.length-1).replace(/\\(['"])/,d=>d.replace("\\",""))),o.push(c)}this.data[r]=o,t--}else if(t<e.length-1&&I(e[t+1])>s){t++;const o=I(e[t]),c=new h;t=c.parse(e,t,o,r)-1,this.data[r]=c}else{let o=e[t].substring(e[t].indexOf(":")+2);o.charAt(0)=="'"||o.charAt(0)=='"'?o=o.substring(1,o.length-1):isNaN(o)||(ee.INT.test(o)?o=parseInt(o):o=parseFloat(o)),typeof o=="string"&&(o=="false"?o=!1:o=="true"?o=!0:o=o.replace(/\\(['"])/,c=>c.replace("\\",""))),this.data[r]=o}do t++;while(t<e.length&&e[t].replace(/ /g,"").charAt(0)=="#")}return Object.keys(this.data).length==1&&this.key&&this.data[this.key]instanceof h&&(this.data=this.data[this.key].data),t});l(this,"toString",()=>this.toYaml(this.key||this.data.name?"'"+(this.key||this.data.name)+"'":void 0,this.data));l(this,"toYaml",(e,t,s="")=>{if(t instanceof h)return t.toYaml("'"+(e??t.key)+"'",t.data,s);let n="";e&&(n+=s+e+`:
`,s+="  ");for(const r of Object.keys(t)){const o=t[r];let c="";if(o!=null){if(o instanceof Object)if(Object.keys(o).includes("toYaml"))if(o instanceof h){n+=o.toYaml("'"+r+"'",o.data,s);continue}else c=o.toYaml(s);else o instanceof Array&&(c=this.convertArray(r,s,o));else{const d=JSON.stringify(o);c=s+r+": "+d+`
`}c&&(n+=c.replaceAll(/(\\)?'/g,"\\'").replaceAll(/((\\)?")/g,d=>d.length==1?"'":d).replaceAll(/\\"/g,'"'))}}return n});this.key=e}convertArray(e,t,s){if(e!="attributes"){let n=t+e+":";if(["string","number"].includes(typeof s[0]))s.length>0?(n+=`
`,s.forEach(r=>n+=t+"- "+JSON.stringify(r)+`
`)):n+=` []
`;else if(e==="components"||e==="children")if(s.length==0)n+=` {}
`;else return n+=`
`,s.forEach(r=>n+=this.toYaml(r.name+"-"+de(),r.toYamlObj(),t+"  ")),n.replaceAll(/'/g,'"');else n+=` []
`;return n}else return this.toYaml(e,s,t)}}class p{constructor(e,t,s){l(this,"name");l(this,"base");l(this,"scale");l(this,"toYaml",(e="")=>e+this.name.toLowerCase()+"-base: "+this.base+`
`+e+this.name.toLowerCase()+"-scale: "+this.scale+`
`);this.name=e,this.base=t,this.scale=s}}class w{constructor(e){l(this,"key",{});l(this,"isFolder",!0);l(this,"open",!1);l(this,"name","Folder");l(this,"data",[]);l(this,"parent");l(this,"updateParent",e=>{this.parent=e});l(this,"add",e=>{this.data.includes(e)||(e instanceof w&&(Y(e,this.data),Fe(e),e.parent=this),this.data.push(e),this.sort())});l(this,"remove",e=>{this.data=this.data.filter(t=>t!=e),this.sort()});l(this,"sort",()=>{this.data=this.data.sort((e,t)=>{let s=0;return e instanceof w&&(t instanceof w||(s=-100)),e.name.localeCompare(t.name)+s}),J()});l(this,"createFolder",()=>{const e=new w;Y(e,this.data),this.data.push(e),this.sort(),e.updateParent(this)});l(this,"deleteFolder",e=>{this.data=this.data.filter(t=>t!=e)});l(this,"contains",e=>{if(this.data.includes(e))return!0;for(const t of this.data.filter(s=>s instanceof w))if(t.contains(e))return!0;return!1});l(this,"getContainingFolder",e=>{if(this.data.includes(e))return this;for(const t of this.data.filter(s=>s instanceof w)){if(t.data.includes(e))return t;{const s=t.getContainingFolder(e);if(!s)continue;return s}}});e&&(this.data=e,e.forEach(t=>{t instanceof w&&t.isFolder&&t.updateParent(this)}))}}const W=i=>i.replace("_"," ").toLowerCase().replace(/^(.)|\s(.)/g,e=>e.toUpperCase()),te=i=>(i=i.replace("_"," "),i.substring(0,1).toUpperCase()+i.substring(1).toLowerCase()),k=i=>i.sort((e,t)=>e.name.localeCompare(t.name)),we=(i,e)=>{let t=e;localStorage.getItem(i)===null&&localStorage.setItem(i,JSON.stringify(e)),t=JSON.parse(localStorage.getItem(i));const{subscribe:s,set:n,update:r}=f(t);return{subscribe:s,set:o=>(localStorage.setItem(i,JSON.stringify(o)),n(o)),update:r}};class se{}l(se,"new",()=>{throw new Error("'new' method not implemented")});class ke extends se{constructor(t,s){super();l(this,"type");l(this,"name");l(this,"description");l(this,"components",[]);l(this,"data",[]);l(this,"isParent",!0);l(this,"id",{});l(this,"contains",t=>{if(this.components.includes(t))return!0;for(const s of this.components)if(s.contains(t))return!0;return!1});l(this,"removeComponent",t=>{if(this.components.includes(t)){this.components.splice(this.components.indexOf(t),1);return}for(const s of this.components)s.contains(t)&&s.removeComponent(t)});this.type=t,this.name=s.name,this.description=s.description??"",this.components=s.components||[],this.data=s.data||[]}toYamlObj(){const t=new h(this.name);return t.put("type",this.type),t}}const b=class{};let g=b;g.triggers=f({});g.targets=f({});g.conditions=f({});g.mechanics=f({});g.initialized=f(!1);g.getTriggerByName=i=>{var e;return(e=Object.values(a(b.triggers)).find(t=>t.name.toLowerCase()===i.toLowerCase()))==null?void 0:e.component};g.getTargetByName=i=>{var e;return(e=Object.values(a(b.targets)).find(t=>t.name.toLowerCase()===i.toLowerCase()))==null?void 0:e.component};g.getConditionByName=i=>{var e;return(e=Object.values(a(b.conditions)).find(t=>t.name.toLowerCase()===i.toLowerCase()))==null?void 0:e.component};g.getMechanicByName=i=>{var e;return(e=Object.values(a(b.mechanics)).find(t=>t.name.toLowerCase()===i.toLowerCase()))==null?void 0:e.component};g.deserializeComponents=i=>{if(!i||!(i instanceof h))return[];const e=[],t=i.getKeys();for(const s of t){let n;const r=i.get(s),o=r.get("type");if(o==="trigger"){const c=b.getTriggerByName(s.split("-")[0]);c&&(n=c.new())}else if(o==="target"){const c=b.getTargetByName(s.split("-")[0]);c&&(n=c.new())}else if(o==="condition"){const c=b.getConditionByName(s.split("-")[0]);c&&(n=c.new())}else if(o==="mechanic"){const c=b.getMechanicByName(s.split("-")[0]);c&&(n=c.new())}n&&(n.deserialize(r),e.push(n))}return e};const U=class extends ke{constructor(t){super("trigger",t);l(this,"mana",!1);l(this,"cooldown",!1);l(this,"clone",()=>new U({name:this.name,components:[...this.components],mana:this.mana,cooldown:this.cooldown,data:[...this.data]}));this.mana=t.mana||!1,this.cooldown=t.cooldown||!1}toYamlObj(){const t=super.toYamlObj(),s=this.getData();return s.getKeys().length>0&&t.put("data",s),this.components.length>0&&t.put("children",this.components),t}getData(){const t=new h("data");return this.name!="Cast"&&this.name!="Initialize"&&this.name!="Cleanup"&&(t.put("mana",this.mana),t.put("cooldown",this.cooldown)),this.data.filter(s=>s.meetsRequirements(this)).forEach(s=>{const n=s.getData();Object.keys(n).forEach(r=>t.put(r,n[r]))}),t}getRawData(){const t=new h("data");return this.name!="Cast"&&this.name!="Initialize"&&this.name!="Cleanup"&&(t.put("mana",this.mana),t.put("cooldown",this.cooldown)),this.data.forEach(s=>{const n=s.getData();Object.keys(n).forEach(r=>t.put(r,n[r]))}),t}deserialize(t){const s=t.get("data");s&&(this.mana=s.get("mana",!1),this.cooldown=s.get("cooldown",!1),this.data.forEach(n=>n.deserialize(s))),this.components=t.get("children",[],n=>g.deserializeComponents(n))}};let M=U;l(M,"new",()=>new U({name:"null"}));class O{constructor(e){this.isSkill=!0,this.key={},this.type="Dynamic",this.maxLevel=5,this.skillReqLevel=0,this.permission=!1,this.levelReq=new p("level",1,0),this.cost=new p("cost",1,0),this.cooldown=new p("cooldown",0,0),this.cooldownMessage=!0,this.mana=new p("mana",0,0),this.minSpent=new p("points-spent-req",0,0),this.castMessage="&6{player} &2has cast &6{skill}",this.combo="",this.indicator="2D",this.icon={material:"Pumpkin",customModelData:0,lore:["&d{name} &7({level}/{max})","&2Type: &6{type}","","{req:level}Level: {attr:level}","{req:cost}Cost: {attr:cost}","","&2Mana: {attr:mana}","&2Cooldown: {attr:cooldown}"]},this.incompatible=[],this.triggers=[],this.skillReqStr="",this.incompStr=[],this.removeComponent=t=>{if(t instanceof M&&this.triggers.includes(t)){this.triggers.splice(this.triggers.indexOf(t),1);return}for(const s of this.triggers)s.contains(t)&&s.removeComponent(t)},this.serializeYaml=()=>{var n;const t=new h(this.name),s=new h;return s.put("name",this.name),s.put("type",this.type),s.put("max-level",this.maxLevel),s.put("skill-req",(n=this.skillReq)==null?void 0:n.name),s.put("skill-req-lvl",this.skillReqLevel),s.put("needs-permission",this.permission),s.put("cooldown-message",this.cooldownMessage),s.put("msg",this.castMessage),s.put("combo",this.combo),s.put("indicator",this.indicator),s.put("icon",this.icon.material),s.put("icon-data",this.icon.customModelData),s.put("icon-lore",this.icon.lore),s.put("attributes",[this.levelReq,this.cost,this.cooldown,this.mana,this.minSpent]),s.put("incompatible",this.incompatible.map(r=>r.name)),s.put("components",this.triggers),t.data=s.data,t},this.load=t=>{this.name=t.get("name",this.name),this.type=t.get("type",this.type),this.maxLevel=t.get("max-level",this.maxLevel),this.skillReqStr=t.get("skill-req",this.skillReqStr),this.skillReqLevel=t.get("skill-req-lvl",this.skillReqLevel),this.permission=t.get("needs-permission",this.permission),this.cooldownMessage=t.get("cooldown-message",this.cooldownMessage),this.castMessage=t.get("msg",this.castMessage),this.combo=t.get("combo",this.combo),this.indicator=t.get("indicator",this.indicator);const s=t.get("attributes");this.levelReq=new p("level",s.get("level-base"),s.get("level-scale")),this.cost=new p("cost",s.get("cost-base"),s.get("cost-scale")),this.cooldown=new p("cooldown",s.get("cooldown-base"),s.get("cooldown-scale")),this.mana=new p("mana",s.get("mana-base"),s.get("mana-scale")),this.minSpent=new p("points-spent-req",s.get("points-spent-req-base"),s.get("points-spent-req-scale")),this.icon.material=t.get("icon",this.icon.material,te),this.icon.customModelData=t.get("icon-data",this.icon.customModelData),this.icon.lore=t.get("icon-lore",this.icon.lore),this.incompStr=t.get("incompatible",this.incompStr);let n;n=g.initialized.subscribe(r=>{r&&(this.triggers=t.get("components",this.triggers,o=>g.deserializeComponents(o)),n&&n())})},this.postLoad=()=>{this.skillReq=q(this.skillReqStr),this.incompatible=this.incompStr.map(t=>q(t)).filter(t=>!!t)},this.name=e?e.name:"Skill",e!=null&&e.type&&(this.type=e.type),e!=null&&e.maxLevel&&(this.maxLevel=e.maxLevel),e!=null&&e.skillReq&&(this.skillReq=e.skillReq),e!=null&&e.skillReqLevel&&(this.skillReqLevel=e.skillReqLevel),e!=null&&e.permission&&(this.permission=e.permission),e!=null&&e.levelReq&&(this.levelReq=e.levelReq),e!=null&&e.cost&&(this.cost=e.cost),e!=null&&e.cooldown&&(this.cooldown=e.cooldown),e!=null&&e.cooldownMessage&&(this.cooldownMessage=e.cooldownMessage),e!=null&&e.mana&&(this.mana=e.mana),e!=null&&e.minSpent&&(this.minSpent=e.minSpent),e!=null&&e.castMessage&&(this.castMessage=e.castMessage),e!=null&&e.combo&&(this.combo=e.combo),e!=null&&e.indicator&&(this.indicator=e.indicator),e!=null&&e.icon&&(this.icon=e.icon),e!=null&&e.incompatible&&(this.incompatible=e.incompatible),e!=null&&e.triggers&&(this.triggers=e.triggers)}}L.disable_scroll_handling;const T=L.goto;L.invalidate;L.invalidateAll;L.preload_data;L.preload_code;L.before_navigate;L.after_navigate;const be=i=>{const e=[],t=N(i);let s;if(t.key&&!t.data[t.key]){const n=t.key;return n==="loaded"||(s=new O({name:n}),s.load(t),e.push(s)),e}for(const n in t.data)n!="loaded"&&t.data[n]instanceof h&&(s=new O({name:n}),s.load(t.data[n]),e.push(s));return e},ie=(i,e,t,s,n)=>{let r=e;{const m=localStorage.getItem(i);m&&(r=t(m),n&&n(r))}const{subscribe:o,set:c,update:d}=f(r);return{subscribe:o,set:m=>(s&&(m=s(m)),c(m)),update:d}},S=ie("skillData",[],i=>k(be(i)),i=>(ne(i),k(i))),q=i=>{for(const e of a(S))if(e.name==i)return e},v=ie("skillFolders",[],i=>JSON.parse(i,(t,s)=>{if(/\d+/.test(t)){if(typeof s=="string")return q(s);const n=new w(s.data);return n.name=s.name,n}return s}),i=>{const e=JSON.stringify(i,(t,s)=>s instanceof O||s instanceof O?s.name:t==="parent"?void 0:s);return localStorage.setItem("skillFolders",e),k(i)}),V=i=>!!q(i),X=i=>{const e=a(S),t=new O({name:i||"Skill "+(e.length+1)});return e.push(t),S.set(e),t},Ye=i=>{const e=a(v);e.includes(i)||(Y(i,e),e.push(i),e.sort((t,s)=>t.name.localeCompare(s.name)),v.set(e))},Se=i=>{const e=a(v).filter(t=>t!=i);v.set(e)},ve=i=>{const e=a(S).filter(s=>s!=i),t=a(D);S.set(e),t instanceof O&&(e.length===0?T("/"):e.find(s=>s===a(D))||T(`/skill/${e[0].name}`))},z=()=>S.set(k(a(S))),ye=()=>{v.set(k(a(v))),z()},K=i=>{const e=N(i);let t;if(e.key&&!e.data[e.key]){const s=e.key;t=V(s)?q(s):X(s),t.load(e),z();return}for(const s in e.data)s!="loaded"&&e.data[s]instanceof h&&!V(s)&&(t=V(s)?q(s):X(s),t.load(e.data[s]));z()},Ce=i=>{var t;const e=(t=i.target)==null?void 0:t.result;e&&K(e)},ne=i=>{const e=i||a(S),t=new h;t.put("loaded",!1),e.forEach(s=>t.put(s.name,s.serializeYaml())),localStorage.setItem("skillData",t.toString())};a(S).forEach(i=>i.postLoad());class R{constructor(e){this.isClass=!0,this.key={},this.prefix="",this.group="class",this.manaName="&2Mana",this.maxLevel=40,this.parentStr="",this.permission=!1,this.expSources=273,this.manaRegen=1,this.health=new p("health",20,1),this.mana=new p("mana",20,1),this.attributes=[],this.skillTree="Requirement",this.skills=[],this.icon={material:"Pumpkin",customModelData:0},this.unusableItems=[],this.actionBar="",this.updateAttributes=t=>{const s=[];this.attributes=this.attributes.filter(n=>t!=null&&t.includes(n.name)?(s.push(n.name),!0):!1),t=t.filter(n=>!s.includes(n));for(const n of t)this.attributes.push(new p(n,0,0))},this.serializeYaml=()=>{var n;const t=new h(this.name),s=new h;return s.put("name",this.name),s.put("action-bar",this.actionBar),s.put("prefix",this.prefix),s.put("group",this.group),s.put("mana",this.manaName),s.put("max-level",this.maxLevel),s.put("parent",((n=this.parent)==null?void 0:n.name)||""),s.put("needs-permission",this.permission),s.put("attributes",[this.health,this.mana,...this.attributes]),s.put("mana-regen",this.manaRegen),s.put("tree",this.skillTree.toUpperCase().replace(/ /g,"_")),s.put("blacklist",this.unusableItems),s.put("skills",this.skills.map(r=>r.name)),s.put("icon",this.icon.material),s.put("icon-data",this.icon.customModelData),s.put("icon-lore",this.icon.lore),s.put("exp-source",this.expSources),t.data=s.data,t},this.updateParent=t=>{this.parentStr&&(this.parent=t.find(s=>s.name===this.parentStr))},this.load=t=>{this.name=t.get("name",this.name),this.actionBar=t.get("action-bar",this.actionBar),this.prefix=t.get("prefix",this.prefix),this.group=t.get("group",this.group),this.maxLevel=t.get("max-level",this.maxLevel),this.parentStr=t.get("parent",this.parentStr),this.permission=t.get("needs-permission",this.permission),this.attributes=t.get("attributes",this.attributes,s=>{const n=[],r=s.get("health-base",20),o=s.get("health-scale",1),c=s.get("mana-base",20),d=s.get("mana-scale",1);this.health=new p("health",r,o),this.mana=new p("mana",c,d),s.remove("health-base"),s.remove("health-scale"),s.remove("mana-base"),s.remove("mana-scale");const m={};return Object.keys(s.data).forEach(P=>{const $=P.split("-"),F=W($[0]);m[F]||(m[F]=new p(F,0,0));const j=m[F];$[1]=="base"&&(j.base=Number.parseFloat(s.data[P])),$[1]=="scale"&&(j.scale=Number.parseFloat(s.data[P]))}),n.push(...Object.values(m)),n}),this.manaRegen=t.get("mana-regen",this.manaRegen),this.skillTree=t.get("tree",this.skillTree,W),this.unusableItems=t.get("blacklist",this.unusableItems),this.skills=t.get("skills",this.skills,s=>s.map(n=>q(n)).filter(n=>!!n)),this.icon.material=t.get("icon",this.icon.material,te),this.icon.customModelData=t.get("icon-data",this.icon.customModelData),this.icon.lore=t.get("icon-lore",this.icon.lore),this.expSources=t.get("exp-source",this.expSources)},this.name=e?e.name:"Class",this.prefix=e!=null&&e.prefix?e.prefix:"&6"+this.name,e!=null&&e.group&&(this.group=e.group),e!=null&&e.manaName&&(this.manaName=e.manaName),e!=null&&e.maxLevel&&(this.maxLevel=e.maxLevel),e!=null&&e.parent&&(this.parent=e.parent),e!=null&&e.permission&&(this.permission=e.permission),e!=null&&e.expSources&&(this.expSources=e.expSources),e!=null&&e.health&&(this.health=e.health),e!=null&&e.mana&&(this.mana=e.mana),e!=null&&e.manaRegen&&(this.manaRegen=e.manaRegen),e!=null&&e.attributes&&(this.attributes=e.attributes),e!=null&&e.skillTree&&(this.skillTree=e.skillTree),e!=null&&e.skills&&(this.skills=e.skills),e!=null&&e.icon&&(this.icon=e.icon),e!=null&&e.unusableItems&&(this.unusableItems=e.unusableItems),e!=null&&e.actionBar&&(this.actionBar=e.actionBar)}}const Oe=i=>{const e=[],t=N(i);let s;if(t.key&&!t.data[t.key]){const n=t.key;return n==="loaded"||(s=new R({name:n}),s.load(t),e.push(s)),e}for(const n in t.data)n!="loaded"&&t.data[n]instanceof h&&(s=new R({name:n}),s.load(t.data[n]),e.push(s));return e},oe=(i,e,t,s,n)=>{let r=e;{const m=localStorage.getItem(i);m&&(r=t(m),n&&n(r))}const{subscribe:o,set:c,update:d}=f(r);return{subscribe:o,set:m=>(s&&(m=s(m)),c(m)),update:d}},y=oe("classData",[],i=>k(Oe(i)),i=>(re(i),i.forEach(e=>e.updateParent(i)),k(i)),i=>i.forEach(e=>e.updateParent(i))),E=i=>{for(const e of a(y))if(e.name==i)return e},C=oe("classFolders",[],i=>JSON.parse(i,(t,s)=>{if(s){if(/\d+/.test(t)){if(typeof s=="string")return E(s);const n=new w(s.data);return n.name=s.name,n}return s}}),i=>{const e=JSON.stringify(i,(t,s)=>s instanceof R||s instanceof O?s.name:t==="parent"?void 0:s);return localStorage.setItem("classFolders",e),k(i)}),Z=i=>a(y).forEach(e=>e.updateAttributes(i)),H=i=>!!E(i),_=i=>{const e=a(y),t=new R({name:i||"Class "+(e.length+1)});return e.push(t),y.set(e),t},Ue=i=>{const e=a(C);e.includes(i)||(Y(i,e),e.push(i),e.sort((t,s)=>t.name.localeCompare(s.name)),C.set(e))},Re=i=>{const e=a(C).filter(t=>t!=i);C.set(e)},Le=i=>{const e=a(y).filter(s=>s!=i),t=a(D);y.set(e),t instanceof R&&(e.length===0?T("/"):e.find(s=>s===a(D))||T(`/class/${e[0].name}/edit`))},B=()=>y.set(k(a(y))),qe=()=>{C.set(k(a(C))),B()},G=i=>{const e=N(i);let t;if(e.key&&!e.data[e.key]){const s=e.key;t=H(s)?E(s):_(s),t.load(e),B();return}for(const s in e.data)s!="loaded"&&e.data[s]instanceof h&&!H(s)&&(t=H(s)?E(s):_(s),t.load(e.data[s]));B()},De=i=>{var t;const e=(t=i.target)==null?void 0:t.result;e&&G(e)},re=i=>{const e=i||a(y),t=new h;t.put("loaded",!1),e.forEach(s=>t.put(s.name,s.serializeYaml())),localStorage.setItem("classData",t.toString())},Ie=(()=>{let i=["vitality","spirit","intelligence","dexterity","strength"];{const n=localStorage.getItem("attribs");n&&(i=n.split(","),Z(i))}const{subscribe:e,set:t,update:s}=f(i);return{subscribe:e,set:n=>(localStorage.setItem("attribs",n.join(",")),Z(n),t(n)),update:s}})(),le=i=>{const e=N(i),t=Object.keys(e.data);Ie.set(t)},D=f(void 0),xe=me(D,i=>i instanceof R?"class":"skill"),Je=f(),Pe=f(),x=we("sidebarOpen",!0),$e=f(!0),ae=f(!0),Ne=f(!1),Ve=()=>{a(x)&&(a(xe)=="class"?B():z(),J())},He=()=>x.set(!a(x)),Ke=()=>x.set(!1),Ge=i=>Ne.set(i),Y=(i,e)=>{const t=i.name;let s=1;for(;e.filter(n=>n instanceof w&&n.name==i.name).length>=1;)i.name=t+" ("+s+++")"},je=i=>{i.parent?(i.parent.deleteFolder(i),J()):a(ae)?Re(i):Se(i)},Qe=i=>{var e;i&&((e=Ae(i))==null||e.remove(i),i instanceof R?Le(i):i instanceof O&&ve(i),J())},J=()=>{a(x)&&(a(ae)?qe():ye())},We=()=>{re(),ne()},Fe=i=>{const e=a(C),t=a(v);e.includes(i)&&C.set(e.filter(s=>s!=i)),t.includes(i)&&v.set(t.filter(s=>s!=i))},Ae=i=>{if(i instanceof w)return i.parent;const e=i instanceof R?a(C):a(v);for(const t of e){const s=t.getContainingFolder(i);if(s)return s}},Me=i=>{var t;const e=(t=i.target)==null?void 0:t.result;e&&(e.indexOf("global:")>=0?le(e):e.indexOf("components:")>=0||e.indexOf("group:")==-1&&e.indexOf("combo:")==-1&&e.indexOf("skills:")==-1?K(e):G(e),document.activeElement.blur())},Xe=i=>{i.indexOf("global:")>=0?le(i):i.indexOf("components:")>=0||i.indexOf("group:")==-1&&i.indexOf("combo:")==-1&&i.indexOf("skills:")==-1?K(i.replace(`loaded: false
`,"")):G(i.replace(`loaded: false
`,""))},Ze=i=>{const e=new FileReader;i.name.indexOf("skills")==0?e.onload=Ce:i.name.indexOf("classes")==0?e.onload=De:e.onload=Me,e.readAsText(i)},_e=i=>{const e=i||a(D);e&&Te(e.name+".yml",e.serializeYaml().toString())},Te=(i,e)=>{const t=new Blob([e],{type:"text/plain;charset=utf-8"}),s=document.createElement("a");s.href=URL.createObjectURL(t),s.download=i,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)};export{xe as A,He as B,p as C,E as D,q as E,M as F,Ne as G,Pe as H,ke as I,Ie as J,Ve as K,We as L,W as M,we as N,O as P,g as R,h as Y,Ze as a,D as b,$e as c,Je as d,w as e,Ue as f,Ae as g,Ye as h,ae as i,_e as j,Qe as k,Xe as l,je as m,T as n,C as o,y as p,v as q,Fe as r,Ge as s,S as t,J as u,x as v,_ as w,X as x,R as y,Ke as z};
